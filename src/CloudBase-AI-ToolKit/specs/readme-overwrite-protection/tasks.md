# 实施计划

## 任务列表

- [x] 1. 修改 copyFile 函数增加 README.md 保护逻辑
  - 在 `mcp/src/tools/setup.ts` 中修改 `copyFile` 函数
  - 增加 `shouldSkipReadme` 辅助函数
  - 在复制逻辑中增加对 README.md 的特殊处理
  - _需求: 需求1

- [x] 2. 更新 downloadTemplate 工具参数传递
  - 修改 `downloadTemplate` 工具，将 `template` 参数传递给 `copyFile` 函数
  - 确保模板类型信息能够正确传递到文件复制逻辑
  - _需求: 需求1

- [x] 3. 优化输出信息显示
  - 在跳过 README.md 文件时，在输出信息中明确说明
  - 更新统计信息，区分因 README.md 保护而跳过的文件
  - _需求: 需求1

- [x] 4. 添加单元测试
  - 为 `shouldSkipReadme` 函数添加单元测试
  - 测试不同场景下的文件保护逻辑
  - 确保逻辑正确性
  - _需求: 需求1

- [x] 5. 集成测试验证
  - 测试 rules 模板下载时对 README.md 的保护
  - 测试其他模板的原有行为保持不变
  - 测试 overwrite=true 时的覆盖行为
  - _需求: 需求1

- [x] 6. 更新文档
  - 更新工具描述，说明 README.md 保护功能
  - 在相关文档中说明新的保护机制
  - _需求: 需求1

## 实施优先级

1. **高优先级**：任务1-3（核心功能实现）
2. **中优先级**：任务4-5（测试验证）
3. **低优先级**：任务6（文档更新）

## 风险评估

- **低风险**：修改范围较小，主要是增加保护逻辑
- **向后兼容**：不影响现有功能，只是增加保护机制
- **测试覆盖**：需要充分测试确保逻辑正确 